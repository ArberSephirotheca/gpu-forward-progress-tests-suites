#!amber

SET ENGINE_DATA fence_timeout_ms 10000

SHADER compute test GLSL
#version 460

struct _GLF_struct_0 {
 mat2x4 _f0;
 uint _f1;
} ;

struct _GLF_struct_1 {
 _GLF_struct_0 _f0;
 mat4 _f1;
 ivec4 _f2;
} ;

struct _GLF_struct_2 {
 uint workgroup_size;
 mat4x3 _f0;
 mat2x3 _f1;
 mat4x3 _f2;
 _GLF_struct_1 _f3;
 bvec2 _f4;
} ;

// Contents of injectionSwitch: [0.0, 1.0]
layout(set = 0, binding = 1) uniform buf1 {
 vec2 injectionSwitch;
};
#extension GL_KHR_shader_subgroup_basic : enable
#extension GL_KHR_shader_subgroup_ballot : enable
#extension GL_KHR_shader_subgroup_vote : enable
#extension GL_KHR_shader_subgroup_basic : enable
layout(set = 0, binding = 0) buffer Buf {
 uint buf[];
};
layout(local_size_x = 128, local_size_y = 1, local_size_z = 1) in;
void main()
{
 uvec3 GLF_merged3_0_1_13_1_1_14_2_1_12subgroup_sizeworkgroup_baseworkgroup_id;
 uvec4 GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup;
 uvec4 GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basevirtual_gid;
 uvec4 GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base;
 uvec4 GLF_merged2_0_3_73_3_1_17GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idsubgroup_local_id;
 uvec4 GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id;
 uvec4 GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid;
 uvec3 GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_base;
 GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basevirtual_gid.xyz = GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_base;
 GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.xyz = GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basevirtual_gid.xyz;
 uvec4 GLF_merged2_0_3_73_3_1_13GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnum_workgroup;
 uvec3 GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_id;
 GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz = GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_id;
 uvec2 GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_id;
 do
  {
   GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.xy = GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_id;
  }
 while(false);
 uvec4 GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base;
 uvec4 GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid;
 uvec2 GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size;
 uvec3 GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_id;
 GLF_merged2_0_3_73_3_1_17GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idsubgroup_local_id.xyz = GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_id;
 GLF_merged2_0_3_73_3_1_13GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnum_workgroup.xyz = GLF_merged2_0_3_73_3_1_17GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idsubgroup_local_id.xyz;
 (uvec3(0u, 0u, 0u) ^ (((GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.xyz = (~ (~ (GLF_merged2_0_3_73_3_1_13GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnum_workgroup))).xyz) - uvec3(0u, ((0u) | (0u)), 0u))));
 uint subgroup_id = gl_SubgroupID;
 do
  {
   for(int _injected_loop_counter = (max((0 | (~ (~ (((int(ivec3(((1) | (1)), 0, 1)))))))), ((((1) | (1))) * 1))); _injected_loop_counter != 0; _injected_loop_counter --)
    {
     GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.w = subgroup_id;
    }
  }
 while(false);
 GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.xyz.x = GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.w;
 uint subgroup_size = gl_SubgroupSize;
 GLF_merged3_0_1_13_1_1_14_2_1_12subgroup_sizeworkgroup_baseworkgroup_id.x = subgroup_size;
 GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base.y = GLF_merged3_0_1_13_1_1_14_2_1_12subgroup_sizeworkgroup_baseworkgroup_id.x;
 GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.z = GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base.y;
 if(true)
  {
   GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.y = (~ (~ ((clamp((((uint((injectionSwitch.x)) + (((GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.z)) | ((GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.z))))) - 0u), (((uint((injectionSwitch.x)) + (GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.z))) - 0u), (((uint((injectionSwitch.x)) + (GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.z))) - 0u))))));
  }
 else
  {
  }
 uint subgroup_local_id = gl_SubgroupInvocationID;
 GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base.x = subgroup_local_id;
 GLF_merged2_0_3_73_3_1_17GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idsubgroup_local_id.w = GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base.x;
 GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.xyz.y = GLF_merged2_0_3_73_3_1_17GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idsubgroup_local_id.w;
 GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.x = GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.xyz.y;
 do
  {
   if(((injectionSwitch.x > injectionSwitch.y)))
    {
    }
   else
    {
     GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.y = GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.x;
    }
  }
 while(false);
 uint num_workgroup = gl_NumWorkGroups.x;
 GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.w = num_workgroup;
 do
  {
   GLF_merged2_0_3_73_3_1_13GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnum_workgroup.w = GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.w;
  }
 while(false);
 if(true)
  {
   if(((injectionSwitch.x < injectionSwitch.y)))
    {
     GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.xyz.y = GLF_merged2_0_3_73_3_1_13GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnum_workgroup.w;
    }
   else
    {
    }
  }
 else
  {
  }
 _GLF_struct_2 _GLF_struct_replacement_2 = _GLF_struct_2(((((min(uvec3(((((((uvec4(gl_WorkGroupSize, 0u)) ^ uvec4(0u, 0u, (0u ^ (0u)), 0u))) | (((uvec4(gl_WorkGroupSize, 0u)) ^ uvec4(0u, 0u, (0u ^ (0u)), 0u))))) - (uvec4(0u, 0u, 0u, 0u) << (uvec4(6u))))), uvec3(((uvec4(gl_WorkGroupSize, 0u)) ^ uvec4(0u, 0u, 0u, 0u)))))) >> uvec3((~ (((~ (0u))) / ((true ? (uint(uvec2(1u, (0u << (uint(0u)))))) : (GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_id.g))))), 0u, (clamp(0u, 0u, 0u))))).x, mat4x3(1.0), mat2x3((clamp(1.0, 1.0, 1.0))), mat4x3(1.0), _GLF_struct_1(_GLF_struct_0(mat2x4(1.0), 1u), (mat4(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ((0.0 + ((((0.0) / 1.0)) - 0.0))), 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0) + (transpose(transpose((mat4(1.0)))))), ivec4(1)), bvec2(true));
 do
  {
   GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size.y = _GLF_struct_replacement_2.workgroup_size;
  }
 while(false);
 uint workgroup_id = (((clamp((~ (~ (gl_WorkGroupID))), gl_WorkGroupID, gl_WorkGroupID))) >> (uvec3((((uvec4(0u, 0u, 0u, 0u) | ((((((true ? uvec4(1u, 1u, 1u, 1u) : (uaddCarry(GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid, GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid, GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid))))) ^ uvec4(0u, 0u, 0u, 0u)) * (uvec4(uvec3(0u, 0u, 0u), ((min(uint(uint(uint((injectionSwitch.y)))), uint(uint(uint((injectionSwitch.y))))))))))))) ^ uvec4(0u, 0u, 0u, 0u))))).x;
 GLF_merged3_0_1_13_1_1_14_2_1_12subgroup_sizeworkgroup_baseworkgroup_id.z = workgroup_id;
 GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.z = GLF_merged3_0_1_13_1_1_14_2_1_12subgroup_sizeworkgroup_baseworkgroup_id.z;
 for(int _injected_loop_counter = 0; (true && ((((~ (~ (_injected_loop_counter)))) * 1) < ((false ? (_injected_loop_counter) : ((int(((clamp((vec2(1.0, 1.0) * ((min(injectionSwitch, (vec2((max(injectionSwitch[(clamp(0, 0, 0))], ((true ? (((vec2(mat2x3(injectionSwitch, 0.0, 0.0, 0.0, 1.0))) / vec2(1.0, 1.0))) : (injectionSwitch)))[0])), injectionSwitch[1])))))), (min(injectionSwitch, (vec2((max(injectionSwitch[0], injectionSwitch[0])), injectionSwitch[1])))), (vec2(0.0, 0.0) + ((min(injectionSwitch, (vec2((max(injectionSwitch[0], injectionSwitch[0])), injectionSwitch[1])))))))).y)) << (int(4))) >> (((((((int(4)))) << 0) | ((int(4)))) ^ 0))))))); _injected_loop_counter ++)
  {
   GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.xy.y = (max(GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.z, (0u ^ (GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.z))));
  }
 for(int _injected_loop_counter = 0; _injected_loop_counter != int((injectionSwitch.y)); _injected_loop_counter ++)
  {
   if(((injectionSwitch.x > injectionSwitch.y)))
    {
    }
   else
    {
     GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.xyz.z = ((((false ? (GLF_merged2_0_3_73_3_1_13GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnum_workgroup.w) : GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.xy.y))) + 0u);
    }
  }
 uint workgroup_base = GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size.y * (((uint(uvec2(GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.xyz.z, 1u))) | (uint(uvec2(GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.xyz.z, 1u)))));
 GLF_merged3_0_1_13_1_1_14_2_1_12subgroup_sizeworkgroup_baseworkgroup_id.y = workgroup_base;
 GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base.w = GLF_merged3_0_1_13_1_1_14_2_1_12subgroup_sizeworkgroup_baseworkgroup_id.y;
 GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.xyz.z = GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base.w;
 GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.w = GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.xyz.z;
 if((bool((bvec2(bvec4((bvec2(bvec4(bvec2((((true && (injectionSwitch.x > injectionSwitch.y)))), false), true, false))), false, false))))))
  {
  }
 else
  {
   if(true)
    {
     GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size.x = GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.w;
    }
   else
    {
    }
  }
 uint virtual_gid = (((~ (~ (uvec2(((uvec4((~ (~ (((~ (~ ((min(((true ? (((true && (injectionSwitch.x > injectionSwitch.y)))) ? (uvec2(165336u, 130314u)) : (clamp(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, (uvec2((max(uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u), (~ (~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u)))))))), GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size)) : (GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.xy))), (min(((false ? (uvec2(52384u, 131991u)) : (((true && (injectionSwitch.x > injectionSwitch.y)))) ? (uvec2(165336u, 130314u)) : (clamp(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, (uvec2((max(uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u), (max((uvec3(uvec3((~ (min(((max(~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u)), ~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u))))), (~ (~ ((min(((max(~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u)), ~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u))))), ((max(~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u)), ~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u)))))))))))))))), (~ (~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u)))))))))), GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size)))), (((! (! ((((true && (injectionSwitch.x > injectionSwitch.y)))))))) && true) ? (uvec2((~ (~ ((min(((165336u) << 0u), 165336u))))), 130314u)) : (clamp(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, (uvec2((max(uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u), (max((uvec3((~ (~ (uvec3((~ (~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u)))))))))), (~ (~ (uvec3(GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size, 1u)))))))))), GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size))))))))))))), (1u ^ 1u), 0u)) ^ uvec4(0u, 0u, 0u, 0u)))))))).x + GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.xyz.x * (~ (~ (GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.y))) + GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.y;
 GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basevirtual_gid.w = virtual_gid;
 GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base.z = GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basevirtual_gid.w;
 GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.w = GLF_merged4_0_1_17_1_1_13_2_1_11_3_1_14subgroup_local_idsubgroup_sizevirtual_gidworkgroup_base.z;
 if(false)
  {
  }
 else
  {
   GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.xy.x = GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.w;
  }
 if(true)
  {
   GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.z = GLF_merged3_0_2_48_2_1_13_3_1_11GLF_merged2_0_1_11_1_1_12virtual_gidworkgroup_idsubgroup_sizevirtual_gid.xy.x;
  }
 else
  {
  }
 uint next_virtual_gid = GLF_merged2_0_1_14_1_1_14workgroup_baseworkgroup_size.x + (0u ^ (((GLF_merged2_0_3_74_3_1_11GLF_merged3_0_1_11_1_1_17_2_1_14subgroup_idsubgroup_local_idworkgroup_basesubgroup_id.xyz.x) - 0u))) * ((((GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.y) | 0u) + 0u)) + (((min(GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base, GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base)).y + 1) % GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.y);
 if(((injectionSwitch.x > injectionSwitch.y)))
  {
  }
 else
  {
   do
    {
     if((! (! (true))))
      {
       (((~ (~ (~ ((~ (((GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.x = next_virtual_gid) << 0u)))))))) << (0u | 0u));
      }
     else
      {
      }
    }
   while((bool(bvec4(false, false, false, false))));
  }
 GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.w = GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.x;
 for(int _injected_loop_counter = (0 << (int(8))); _injected_loop_counter != 1; _injected_loop_counter ++)
  {
   GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.xyz.x = GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.w;
  }
 if(false)
  {
  }
 else
  {
   do
    {
     ((1u ^ 1u) | (((buf[GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.z] = 1) >> 0u)));
    }
   while(false);
  }
 for(int _injected_loop_counter = ((- 13286 & 0) | (int((injectionSwitch.y)))); (bool(bvec3(_injected_loop_counter > (1 ^ 1), true, true))); _injected_loop_counter --)
  {
   if((((! (false || ((! (injectionSwitch.x < ((injectionSwitch) + vec2((mix(float((- 17.06)), float(0.0), bool(true))), 0.0)).y))))))))
    {
     for(int _injected_loop_counter = int(((((max(injectionSwitch, ((injectionSwitch) / vec2(1.0, 1.0))))) + vec2(0.0, 0.0)).y)); _injected_loop_counter != (0 >> (int(2))); _injected_loop_counter --)
      {
       if(((injectionSwitch.x < injectionSwitch.y)))
        {
         for(int _injected_loop_counter = ((1 << (((int(3)) | (((int(3)) | 0))))) >> (int(3))); (false || (_injected_loop_counter != int((injectionSwitch.x)))); _injected_loop_counter --)
          {
           do
            {
             for(int _injected_loop_counter = 1; _injected_loop_counter > 0; _injected_loop_counter --)
              {
               if(true)
                {
                 if(GLF_merged4_0_1_16_1_1_17_2_1_11_3_1_14next_virtual_gidsubgroup_local_idvirtual_gidworkgroup_base.y + 1 < GLF_merged2_0_3_74_3_1_13GLF_merged3_0_1_17_1_1_13_2_1_12subgroup_local_idsubgroup_sizeworkgroup_idnum_workgroup.xyz.y)
                  {
                   do
                    {
                     if((bool((bvec2(bvec4(bvec2(((injectionSwitch.x < injectionSwitch.y)), ((injectionSwitch.x > injectionSwitch.y))), false, true))))))
                      {
                       for(int _injected_loop_counter = 1; _injected_loop_counter > 0; _injected_loop_counter --)
                        {
                         buf[GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.xyz.x] = 2;
                        }
                      }
                     else
                      {
                      }
                    }
                   while(false);
                   subgroupAll(false);
                  }
                 else
                  {
                   buf[GLF_merged2_0_3_73_3_1_16GLF_merged3_0_1_16_1_1_13_2_1_12next_virtual_gidnum_workgroupworkgroup_idnext_virtual_gid.xyz.x] = 2;
                   if(false)
                    {
                    }
                   else
                    {
                     do
                      {
                       do
                        {
                         subgroupAll(true);
                        }
                       while((((bool(bvec2(false, true)))) && true));
                      }
                     while(((injectionSwitch.x > injectionSwitch.y)));
                    }
                  }
                }
               else
                {
                }
              }
            }
           while(((injectionSwitch.x > (max(injectionSwitch.y, injectionSwitch.y)))));
          }
        }
       else
        {
        }
      }
    }
   else
    {
    }
  }
}

END

BUFFER tester DATA_TYPE uint32 SIZE 8388096 FILL 0
BUFFER expected DATA_TYPE uint32 SIZE 8388096 FILL 2
BUFFER injection DATA_TYPE vec2<float> DATA
 0.0 1.0
END

PIPELINE compute test_pipe
  ATTACH test
  BIND BUFFER tester AS storage DESCRIPTOR_SET 0 BINDING 0 
  BIND BUFFER injection AS uniform DESCRIPTOR_SET 0 BINDING 1 

END

RUN test_pipe 65532 1 1
EXPECT tester EQ_BUFFER expected
